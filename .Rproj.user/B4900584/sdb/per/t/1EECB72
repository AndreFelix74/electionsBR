{
    "collab_server" : "",
    "contents" : "#' Download data on the candidates' background in local elections\n#'\n#' \\code{candidate_local()} downloads and aggregates the data on the candidates' background who vied\n#' local elections in Brazil. The function returns a \\code{data.frame} where each observation\n#' corresponds to a candidate.\n#'\n#' @note For the elections prior to 2000, some information can be incomplete.\n#'\n#' @param year Election year. For this function, onlye the years of 1996, 2000, 2004, 2008, and 2012\n#' are available.\n#'\n#' @return \\code{candidate_local()} returns a \\code{data.frame} with the following variables:\n#'\n#' \\itemize{\n#'   \\item DATA_GERACAO: Generation date of the file (when the data was collected).\n#'   \\item HORA_GERACAO: Generation time of the file (when the data was collected), Brasilia Time.\n#'   \\item ANO_ELEICAO: Election year.\n#'   \\item NUM_TURNO: Round number.\n#'   \\item DESCRICAO_ELEICAO: Description of the election.\n#'   \\item SIGLA_UF: Units of the Federation's acronym in which occurred the election.\n#'   \\item SIGLA_UE: Units of the Federation's acronym (In case of major election is the FU's\n#'   acronym in which the candidate runs for (text) and in case of municipal election is the\n#'   municipal's Supreme Electoral Court code (number)). Assume the special values BR, ZZ and\n#'   VT to designate, respectively, Brazil, Overseas and Absentee Ballot.\n#'   \\item DESCRICAO_UE: Description of the Electoral Unit.\n#'   \\item CODIGO_CARGO: Code of the position that the candidate runs for.\n#'   \\item DESCRICAO_CARGO: Description of the position that the candidate runs for.\n#'   \\item NOME_CANDIDATO: Candidate's complete name.\n#'   \\item SEQUENCIAL_CANDIDATO: Candidate's sequence number generated internally by the electoral\n#'   systems. It is not the candidate's campaign number.\n#'   \\item NUMERO_CANDIDATO: Candidate's number in the ballot box.\n#'   \\item CPF_CANDIDATO: Candidate's CPF.\n#'   \\item NOME_URNA_CANDIDATO: Candidate's ballot box name.\n#'   \\item COD_SITUACAO_CANDIDATURA: Code of the candidature situation.\n#'   \\item DES_SITUACAO_CANDIDATURA: Description of the candidature situation.\n#'   \\item NUMERO_PARTIDO: Party number.\n#'   \\item SIGLA_PARTIDO: Party acronym.\n#'   \\item NOME_PARTIDO: Party name.\n#'   \\item CODIGO_LEGENDA: Sequential code of the party shortname generated by the Electoral Justice.\n#'   \\item SIGLA_LEGENDA: Party's shortname acronym.\n#'   \\item COMPOSICAO_LEGENDA: Party's shortname composition.\n#'   \\item NOME_COLIGACAO: Coalition shortname.\n#'   \\item CODIGO_OCUPACAO: Candidate's occupation code.\n#'   \\item DESCRICAO_OCUPACAO: Candidate's occupation description.\n#'   \\item DATA_NASCIMENTO: Candidate's date of birth.\n#'   \\item NUM_TITULO_ELEITORAL_CANDIDATO: Candidate's ballot number.\n#'   \\item IDADE_DATA_ELEICAO: Candidate's age on the day of election.\n#'   \\item CODIGO_SEXO: Candidate's sex code.\n#'   \\item DESCRICAO_SEXO: Candidate's sex description.\n#'   \\item COD_GRAU_INSTRUCAO: Candidate's level of education code. Generated internally by the electoral systems.\n#'   \\item DESCRICAO_GRAU_INSTRUCAO: Candidate's level of education description.\n#'   \\item CODIGO_ESTADO_CIVIL: Candidate's marital status code.\n#'   \\item DESCRICAO_ESTADO_CIVIL: Candidate's marital status description.\n#'   \\item CODIGO_NACIONALIDADE: Candidate's nationality code.\n#'   \\item DESCRICAO_NACIONALIDADE: Candidate's nationality description.\n#'   \\item SIGLA_UF_NASCIMENTO: Candidate's Units of the Federation birth's acronym.\n#'   \\item COD_MUNICIPIO_NASCIMENTO: Candidate's birth city's Supreme Electoral Court code.\n#'   \\item COD_MUNICIPIO_NASCIMENTO: Candidate's birth city.\n#'   \\item DESPESA_MAX_CAMPANHA: Maximum expenditure campaign declared by the party to that position. Values in Reais.\n#'   \\item COD_SIT_TOT_TURNO: Candidate's totalization status code in that election round.\n#'   \\item DESC_SIT_TOT_TURNO: Candidate's totalization status description in that round.\n#'   \\item CODIGO_COR_RACA: Candidate's color/race code (self-declaration, only for 2016 election).\n#'   \\item DESCRICAO_COR_RACA: Candidate's color/race description (self-declaration, only for 2016 election).\n#'   \\item EMAIL_CANDIDATO: Candidate's e-mail adress (only for 2014 election).\n#' }\n#'\n#' @import utils\n#' @importFrom magrittr \"%>%\"\n#' @export\n#' @examples\n#' \\dontrun{\n#' df <- candidate_local(2000)\n#' }\n\ncandidate_local <- function(year){\n\n\n  # Input tests\n  test_local_year(year)\n\n  # Downloads the data\n  dados <- tempfile()\n  sprintf(\"http://agencia.tse.jus.br/estatistica/sead/odsele/consulta_cand/consulta_cand_%s.zip\", year) %>%\n    download.file(dados)\n  unzip(dados, exdir = paste0(\"./\", year))\n  unlink(dados)\n\n  cat(\"Processing the data...\")\n\n  # Cleans the data\n  setwd(as.character(year))\n  banco <- juntaDados()\n  setwd(\"..\")\n  unlink(as.character(year), recursive = T)\n\n  # Changes variables names\n  if(year < 2012){\n    names(banco) <- c(\"DATA_GERACAO\", \"HORA_GERACAO\", \"ANO_ELEICAO\", \"NUM_TURNO\", \"DESCRICAO_ELEICAO\",\n                      \"SIGLA_UF\", \"SIGLA_UE\", \"DESCRICAO_UE\", \"CODIGO_CARGO\", \"DESCRICAO_CARGO\",\n                      \"NOME_CANDIDATO\", \"SEQUENCIAL_CANDIDATO\", \"NUMERO_CANDIDATO\", \"CPF_CANDIDATO\",\n                      \"NOME_URNA_CANDIDATO\", \"COD_SITUACAO_CANDIDATURA\", \"DES_SITUACAO_CANDIDATURA\",\n                      \"NUMERO_PARTIDO\", \"SIGLA_PARTIDO\", \"NOME_PARTIDO\", \"CODIGO_LEGENDA\", \"SIGLA_LEGENDA\",\n                      \"COMPOSICAO_LEGENDA\", \"NOME_COLIGACAO\", \"CODIGO_OCUPACAO\", \"DESCRICAO_OCUPACAO\",\n                      \"DATA_NASCIMENTO\", \"NUM_TITULO_ELEITORAL_CANDIDATO\", \"IDADE_DATA_ELEICAO\",\n                      \"CODIGO_SEXO\", \"DESCRICAO_SEXO\", \"COD_GRAU_INSTRUCAO\", \"DESCRICAO_GRAU_INSTRUCAO\",\n                      \"CODIGO_ESTADO_CIVIL\", \"DESCRICAO_ESTADO_CIVIL\", \"CODIGO_NACIONALIDADE\",\n                      \"DESCRICAO_NACIONALIDADE\", \"SIGLA_UF_NASCIMENTO\", \"CODIGO_MUNICIPIO_NASCIMENTO\",\n                      \"NOME_MUNICIPIO_NASCIMENTO\", \"DESPESA_MAX_CAMPANHA\", \"COD_SIT_TOT_TURNO\",\n                      \"DESC_SIT_TOT_TURNO\")\n\n  } else if(year == 2012) {\n    names(banco) <-c(\"DATA_GERACAO\", \"HORA_GERACAO\", \"ANO_ELEICAO\", \"NUM_TURNO\", \"DESCRICAO_ELEICAO\",\n                     \"SIGLA_UF\", \"SIGLA_UE\", \"DESCRICAO_UE\", \"CODIGO_CARGO\", \"DESCRICAO_CARGO\",\n                     \"NOME_CANDIDATO\", \"SEQUENCIAL_CANDIDATO\", \"NUMERO_CANDIDATO\", \"CPF_CANDIDATO\",\n                     \"NOME_URNA_CANDIDATO\", \"COD_SITUACAO_CANDIDATURA\", \"DES_SITUACAO_CANDIDATURA\",\n                     \"NUMERO_PARTIDO\", \"SIGLA_PARTIDO\", \"NOME_PARTIDO\", \"CODIGO_LEGENDA\", \"SIGLA_LEGENDA\",\n                     \"COMPOSICAO_LEGENDA\", \"NOME_COLIGACAO\", \"CODIGO_OCUPACAO\", \"DESCRICAO_OCUPACAO\",\n                     \"DATA_NASCIMENTO\", \"NUM_TITULO_ELEITORAL_CANDIDATO\", \"IDADE_DATA_ELEICAO\",\n                     \"CODIGO_SEXO\", \"DESCRICAO_SEXO\", \"COD_GRAU_INSTRUCAO\", \"DESCRICAO_GRAU_INSTRUCAO\",\n                     \"CODIGO_ESTADO_CIVIL\", \"DESCRICAO_ESTADO_CIVIL\", \"CODIGO_NACIONALIDADE\",\n                     \"DESCRICAO_NACIONALIDADE\", \"SIGLA_UF_NASCIMENTO\", \"CODIGO_MUNICIPIO_NASCIMENTO\",\n                     \"NOME_MUNICIPIO_NASCIMENTO\", \"DESPESA_MAX_CAMPANHA\", \"COD_SIT_TOT_TURNO\",\n                     \"DESC_SIT_TOT_TURNO\", \"EMAIL_CANDIDATO\")\n    \n  } else {\n    \n    names(banco) <-c(\"DATA_GERACAO\", \"HORA_GERACAO\", \"ANO_ELEICAO\", \"NUM_TURNO\", \"DESCRICAO_ELEICAO\",\n                     \"SIGLA_UF\", \"SIGLA_UE\", \"DESCRICAO_UE\", \"CODIGO_CARGO\", \"DESCRICAO_CARGO\",\n                     \"NOME_CANDIDATO\", \"SEQUENCIAL_CANDIDATO\", \"NUMERO_CANDIDATO\", \"CPF_CANDIDATO\",\n                     \"NOME_URNA_CANDIDATO\", \"COD_SITUACAO_CANDIDATURA\", \"DES_SITUACAO_CANDIDATURA\",\n                     \"NUMERO_PARTIDO\", \"SIGLA_PARTIDO\", \"NOME_PARTIDO\", \"CODIGO_LEGENDA\", \"SIGLA_LEGENDA\",\n                     \"COMPOSICAO_LEGENDA\", \"NOME_COLIGACAO\", \"CODIGO_OCUPACAO\", \"DESCRICAO_OCUPACAO\",\n                     \"DATA_NASCIMENTO\", \"NUM_TITULO_ELEITORAL_CANDIDATO\", \"IDADE_DATA_ELEICAO\",\n                     \"CODIGO_SEXO\", \"DESCRICAO_SEXO\", \"COD_GRAU_INSTRUCAO\", \"DESCRICAO_GRAU_INSTRUCAO\",\n                     \"CODIGO_ESTADO_CIVIL\", \"DESCRICAO_ESTADO_CIVIL\", \"CODIGO_COR_RACA\", \"DESCRICAO_COR_RACA\",\n                     \"CODIGO_NACIONALIDADE\", \"DESCRICAO_NACIONALIDADE\", \"SIGLA_UF_NASCIMENTO\", \n                     \"CODIGO_MUNICIPIO_NASCIMENTO\", \"NOME_MUNICIPIO_NASCIMENTO\", \"DESPESA_MAX_CAMPANHA\",\n                     \"COD_SIT_TOT_TURNO\", \"DESC_SIT_TOT_TURNO\", \"EMAIL_CANDIDATO\")\n  }\n\n  cat(\"Done\")\n  return(banco)\n}\n",
    "created" : 1471705664089.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1184298811",
    "id" : "1EECB72",
    "lastKnownWriteTime" : 1471706232,
    "last_content_update" : 1471706232360,
    "path" : "~/GitHub/electionsBR/R/candidate_local.R",
    "project_path" : "R/candidate_local.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}